\documentclass[12pt,a4paper]{article} 
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage[utf8x]{inputenc} 
\usepackage[encapsulated]{CJK}
\usepackage{textcomp} 
\usepackage{hyperref}
\usepackage{float}
\usepackage[]{algorithm2e}
\usepackage{algpseudocode}
\begin{CJK}{UTF8}{bsmi} 
	\title{Homework4 - Gaussian Distribution,Uniform Distribution,Box-M\"{u}ller transformation } 
	\author{Professor : Ren Jung Chang 張仁宗 \\Student : N16066176 Chen Wei Yu 余振瑋} 
	\date{Oct 14 2017}
\begin{document}	 
	\maketitle
	\begin{abstract}
		The homework 4 is designed for disgussing the uniform distribution of an random sequences with the mean and standard deviation. And how to use the transformation technique to generate the exponential deviate or the normal deviate from the uniform distribution sequences.
	\end{abstract}
	\listoffigures
	\section{Homework Problem}
		\subsection{Prblem 1}
			\subsubsection{Problem}
			\paragraph{Use} Matlab to generate Gaussian $x_{i}$ with specified mean $\mu_{x}$ and the standard deviation $\sigma_{x}$, and plot time series, distribution diagram, and histogram.
			\subsubsection{Answer}
			\begin{figure}[H]
				\centering
				\includegraphics[scale=0.4]{Problem1a}
				\caption[Histogram of normrnd]{Histogram of normrnd}
			\end{figure}
			\begin{figure}[H]
				\centering
				\includegraphics[scale=0.35]{Problem1b}
				\caption[Sequence with normrnd]{Sequence with normrnd}
			\end{figure}
			\begin{figure}[H]
				\centering
				\includegraphics[scale=0.3]{Problem1c}
				\caption[Error between estimated mean and true mean]{Error between estimated mean and true mean with different sequence in semilog diagram}
			\end{figure}
		\subsection{Problem 2}
			\subsubsection{Problem}
				\paragraph{Use}Box-M\"{u}ller transformation to generate two independent Gaussian sequences through input two independent uniform distributions generated by yourself.
			\subsubsection{Answer}
				\paragraph{There}are two classical ways to implement the Box-M\"{u}ller method\cite{Box1}\cite{Box2}. One way is using two independent variables $x_{1} \sim U[0,1]\,and\,x_{2} \sim U[0,1]$ with the trigonometric operations in the Cartesian cordinate, the other is based on the previous method but changes the cordinate to the polar cordinate.
				\paragraph{To}understand the tranformation method, we discuss the 
				"exponential deviate" at first.Consider $x\sim U[0,1]$ and y is an exponential distribution in $[0,1].$ The probability density function of y is defined as\\ 
				\begin{equation}
				g(y)= \{
				\begin{tabular}{c}
				0 , y$<$0\\
				$\lambda e^{-\lambda y} , y \geq0.$
				\end{tabular}
				\end{equation}
				By the fundamental transformation law of probabilities, we can get 
				\begin{equation}
				x=G(y)=\int_{\infty}^{y}g(u)du=1-e^{-\lambda y}
				\end{equation}
				so we can get the exponential deviates of y by inserting $x \sim U[0,1]$ to
				\begin{equation}
				y=-ln|1-x|.
				\end{equation}
				\paragraph{The}transformation can be applied on more than one dimension. If $x_{1},x_{2}\cdots$are random deviates with a joint probability distribution $p(x_{1},x_{2},\cdots)dx_{1}dx_{2}\cdots$, and if $y_{1},y_{2},\cdots$are each functions of all the x's(same number of as x's),then the joint probability distribution of the y's is\\
				\begin{equation}
				p(y_{1},y_{2},\cdots)dy_{1}dy_{2}\cdots=p(x_{1},x_{2},\cdots) |\frac{\partial(x_{1},x_{2},\cdots)}{\partial(y_{1},y_{2},\cdots)}|dy_{1}dy_{2}\cdots
				\end{equation}
				where $\frac{\partial()}{\partial()}$ is the Jacobian determinant of the x's with respect to the y's.
				\paragraph{The} transformation is the spirit behind the Box-M\"{u}ller method. The other descirptions are same as the hint of homework.
				\paragraph{Figure 6}shows that the two random variables will be form an cirle region which is same as the assumption of the modified Box-M\"{u}ller method.
				\paragraph{Figure 17$\sim$26}show that the estimated mean will converge to the ture mean no metter the different mean values or the different the standard deviation values. \\
				\newline
				\begin{algorithm}[H]
					\caption{Box\-M\"{u}ller method in the polar form}
					\KwIn{$\mu,\sigma$}
					\KwResult{Return two normal deviate random numbers}
					RSQ=0;(RSQ : square root of square sum)\\
					\While{RSQ=0 or RSQ$\geq$1}{
						let$\,z_{1}\,and\,z_{2} \sim U[-1,1]$ which is in the unit circle \\
						\quad $z_{1}=rand()*2-1.0$\\
						\quad$z_{2}=rand()*2-1.0$\\
						\quad RSQ=$z_{1}^{2}+z_{2}^{2}$\\
						\quad FAC=$\sqrt{\|(-2\times ln(RSQ)/RSQ)\|}$\\
						\If{($RSQ\neq0$) and (RSQ$<$1)}{break}
					}
					$x_{1}=z_{1}\times FAC*\sigma+\mu$\\
					$x_{2}=z_{2}\times FAC*\sigma+\mu$\\
					\KwOut{$x_{1},x_{2}$}
				\end{algorithm} 
				
				\begin{algorithm}[H]
					\caption{Box\-M\"{u}ller method with trigonometric operation}
					\KwIn{$\mu,\sigma$}
					\KwResult{Return two normal deviate random numbers}
					$R_{1}$=0;($R_{1}\,$ : first uniform random nomber )\\
					\While{$R_{1}$=0}{
						let$\,R_{1}\sim U[0,1]\,but \neq 0$\\
						\quad $R_{1}=rand()$\\
						\If{$R_{1}\neq0$}{break}
					}
					$R_{2}=rand$\\
					$Left=\sqrt{-2*ln(R1)}$\\
					$x_{1}=Left\times\cos(2\times\pi \times R_{2})\times\sigma+\mu$\\
					$x_{2}=Left\times\sin(2\times\pi \times R_{2})\times\sigma+\mu$\\
					\KwOut{$x_{1},x_{2}$}
				\end{algorithm}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.4]{Problem2a1}
					\caption[Histogram of Box-M\"{u}ller methods and normrnd ]{The first two columns are the random numbers generated by the Box\-M\"{u}ller method in polar form. The third and fourth column are the random numbers generated by the Box\-M\"{u}ller method with the trigonometric operation. Final one is generated by the naive Matlab function normrnd.}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.4]{Problem2a2}
					\caption[Sequence diagram of Box\-M\"{u}ller methods and normrnd ]{The first two columns are the random numbers generated by the Box\-M\"{u}ller method in polar form with the sequence. The third and fourth column are sequence plot of the random numbers generated by the Box\-M\"{u}ller method with the trigonometric operation. Final one is generated by the naive Matlab function normrnd.}
				\end{figure} 
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.6]{Problem2a3}
					\includegraphics[scale=0.4]{Problem2a4}
					\caption[Cordinate of two normal random numbers]{Using the first Box\-M\"{u}ller method shows that the two normal distribution random numbers can be generated from an circle region.}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.35]{Problem2b1}
					\caption[Histogram of first random number by Box\-M\"{u}ller  method in polar form]{Histogram of first random number by Box\-M\"{u}ller method in polar form with different standard deviations}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.35]{Problem2b2}
					\caption[Histogram of second random number by Box\-M\"{u}ller method in polar form with different standard deviations]{Histogram of second random number by Box\-M\"{u}ller method in polar form with different standard deviations}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.35]{Problem2b3}
					\caption[Histogram of first random number by Box\-M\"{u}ller  method in trigonometric operation with different standard deviations]{Histogram of first random number by Box\-M\"{u}ller method in trigonometric operation with different standard deviations}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.35]{Problem2b4}
					\caption[Histogram of second random number by Box\-M\"{u}ller  method in trigonometric operation with different standard deviations]{Histogram of second random number by Box\-M\"{u}ller method in trigonometric operation with different standard deviations}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.35]{Problem2b5}
					\caption[Histogram of random number by naive function normrnd]{Histogram of random number by naive function normrnd with different standard deviations}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.35]{Problem2c1}
					\caption[Histogram of first random number by Box\-M\"{u}ller  method in polar form with means]{Histogram of first random number by Box\-M\"{u}ller method in polar form with different means}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.35]{Problem2c2}
					\caption[Histogram of second random number by Box\-M\"{u}ller method in polar form with different means]{Histogram of second random number by Box\-M\"{u}ller method in polar form with different means}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.35]{Problem2c3}
					\caption[Histogram of first random number by Box\-M\"{u}ller  method in trigonometric operation with different means]{Histogram of first random number by Box\-M\"{u}ller method in trigonometric operation with different means}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.5]{Problem2c4}
					\caption[Histogram of second random number by Box\-M\"{u}ller  method in trigonometric operation with different meanns]{Histogram of second random number by Box\-M\"{u}ller method in trigonometric operation with different means}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.5]{Problem2c5}
					\caption[Histogram of random number by naive function normrnd with different means]{Histogram of random number by naive function normrnd with different means}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.55]{Problem2d1}
					\caption[Mean of first random number by Box\-M\"{u}ller  method in polar form with different standard deviations]{Mean of first random number by Box\-M\"{u}ller method in polar form with different deviations in semilog scale}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.55]{Problem2d2}
					\caption[Mean of second random number by Box\-M\"{u}ller  method in polar form with different standard deviations]{Mean of second random number by Box\-M\"{u}ller method in polar form with different deviations in semilog scale}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.55]{Problem2d3}
					\caption[Mean of first random number by Box\-M\"{u}ller  method in trigonometric operation with different standard deviations]{Mean of first random number by Box\-M\"{u}ller method in trigonometric operation with different standard deviations in semilog scale}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.5]{Problem2d4}
					\caption[Mean of second random number by Box\-M\"{u}ller  method in trigonometric operation with different standard deviations]{Mean of second random number by Box\-M\"{u}ller method in trigonometric operation with different standard deviations in semilog scale}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.5]{Problem2d5}
					\caption[Mean of random number by naive function normrnd]{Mean of random number by naive function normrnd with different standard deviations}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.5]{Problem2e1}
					\caption[Mean of first random number by Box\-M\"{u}ller method in polar form with means]{Mean of first random number by Box\-M\"{u}ller method in polar form with different means}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.5]{Problem2e2}
					\caption[Mean of second random number by Box\-M\"{u}ller method in polar form with means]{Mean of second random number by Box\-M\"{u}ller method in polar form with different means}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.5]{Problem2e3}
					\caption[Mean of first random number by Box\-M\"{u}ller method using trigonometric operation with different means]{Mean of first random number by Box\-M\"{u}ller method using trigonometric operation with different means}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.5]{Problem2e4}
					\caption[Mean of second random number by Box\-M\"{u}ller  method using trigonometric operation with different means]{Mean of second random number by Box\-M\"{u}ller method using trigonometric operation with different means}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.5]{Problem2e5}
					\caption[Mean of random number by naive function normrnd with different means]{Mean of random number by naive function normrnd with different means}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.35]{Problem2f1}
					\caption[STD of first random number by Box\-M\"{u}ller method in polar form with STDs]{STD of first random number by Box\-M\"{u}ller method in polar form with different STDs}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.35]{Problem2f2}
					\caption[STD of second random number by Box\-M\"{u}ller  method in polar form with STDs]{STD of second random number by Box\-M\"{u}ller method in polar form with different STDs}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.35]{Problem2f3}
					\caption[STD of first random number by Box\-M\"{u}ller  method using trigonometric operation with different STDs]{Mean of first random number by Box\-M\"{u}ller method using trigonometric operation with different STDs}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.35]{Problem2f4}
					\caption[STD of second random number by Box\-M\"{u}ller  method using trigonometric operation with different STDs]{Mean of second random number by Box\-M\"{u}ller method using trigonometric operation with different STDs}
				\end{figure}
				\begin{figure}[H]
					\centering
					\includegraphics[scale=0.35]{Problem2f4}
					\caption[STD of second random number by naive function normrnd with different STDs]{Mean of second random number by naive function normrnd with different STDs}
				\end{figure}
	\subsection{Problem 3}
		\subsubsection{Problem}
			\paragraph{Repeat}problem 1 and 3, by generating a time series of uniform sequence with specified range.
		\subsubsection{Answer}
			\paragraph{The}probability density of an continous uniform distribution sequence is defined as 
			\begin{equation}
			f(x)=\{ 
			\begin{tabular}{c}
			$\frac{1}{b-a}$ , for $a\leq x \leq b$\\
			0 , for $x<a$ or $x>b.$
			\end{tabular}
			\end{equation} 
			\cite{Uniform distribution}
			\begin{equation}
			\int_{a}^{b}f(x)dx=1
			\end{equation}.
			\paragraph{With} the mean and the standard deviation, we can reform the equation 5 to this form \\
			\begin{equation}
			f(x)=\{
			\begin{tabular}{c}
			$\frac{1}{2\sigma\sqrt{3}}$ \, , for $-\sigma\sqrt{3}+\mu\leq x \leq \sigma\sqrt{3}+\mu$\\
			0\, , \,for others
			\end{tabular}
			\end{equation}
			With the equation 7, we can get equation\\
			\begin{equation}
			\sigma=\frac{b-a}{\sqrt{12}},\\
			\mu=\frac{a+b}{2}
			\end{equation}
			\begin{algorithm}[H]
				\caption{Uniform deviate random number generator in the specfied range $U[min,max]$}
				\KwIn{min,max}
				\KwResult{Output of the uniform deviate random number in the range of $[min,max]$}
				DIS=(max-min)/2;\\
				MEAN=(max+min)/2;$\,$Caculating the mean of the range.\\
				STD=$(DIS)/\sqrt{3}$;$\,$ Caculating the standard deviation of the range.\\
				Initialized the variable TMP which $TMP>1.0$\\
			\While{$TMP>1.0$ or $TMP<-1.0$}{
			TMP=(rand-0.5)/0.5\\
			OUT=TMP*DIS+MEAN\\
			\If{$TMP\leq(DIS+MEAN)$ and $TMP\geq(DIS-MEAN)$}{break}
			}
			\KwOut{OUT}
			\end{algorithm}
			
			\begin{figure}[H]
				\centering
				\includegraphics[scale=0.5]{Problem3c}
				\caption[Uniform distribution in spcfied range]{Uniform distribution in specified range}
			\end{figure}
			\begin{figure}[H]
				\centering
				\includegraphics[scale=0.5]{Problem3b}
				\caption[Mean of uniform distribution in specified range with different sequence length in semilog scale]{Mean of uniform distribution in spcfied range with different sequence length in semilog scale}
			\end{figure}
			\begin{figure}[H]
				\centering
				\includegraphics[scale=0.5]{Problem3a}
				\caption[Standard deviation of uniform distribution in specified range with different sequence length in semilog scale]{Standard deviation of uniform distribution in spcfied range with different sequence length in semilog scale}
			\end{figure}
			\paragraph{From}the Figure $17\sim 31$, we can know the Box-M\"{u}ller can generated the normal deviate random numbers at well. We may use the third moment( skewness ) or the fourth moment( kurtosis ) to analyze the performance of the output distribution.
	\section{Code}
	All of my codes can be found at the Gihub\, \href{https://github.com/YuChenWei/Stochastic-Matlab-Code/tree/Homework4}{Stochastic\-Matlab\-Code\-Homework4.}
	\begin{itemize}
		\item BoxM\"{u}ller.m : The file is my own function based on the Box-M\"{u}ller method in polar form.
		\item BoxM\"{u}ller\_Tri.m : The file is my own function based on the Box-M\"{u}ller method with trigonometric operations.
		\item UniRand.m : The file is my own function of uniform distribution random in specified range $U[min,max].$
		\item Problem1.m : Figure 1 $\sim$ 3
		\item Problem2a.m : Figure 4 $\sim$ 6
		\item Problem2b.m : Figure 7 $\sim$ 11
		\item Problem2c.m : Figure 12 $\sim$ 16
		\item Problem2d.m : Figure 17 $\sim$ 21
		\item Problem2e.m : Figure 22 $\sim$ 26
		\item Problem2f.m : Figure 27 $\sim$ 31
		\item Problem3.m : Figure 32 $\sim$ 34
	\end{itemize}
	\begin{thebibliography}{10}
		\bibitem{Box1}Numerical Recipes in C : The Art of Scientific Computing
		\bibitem{Box2}\href{https://en.wikipedia.org/wiki/Box%E2%80%93Muller_transform}{Box–Muller transform from Wikipedia}
		\bibitem{Uniform distribution}\href{https://en.wikipedia.org/wiki/Uniform_distribution_(continuous)}{Uniform distribution from Wikipedia}
	\end{thebibliography}	
\end{CJK} 
\end{document} 
