clc;
clear;
N=100000;
t=1:1:N;
mu=0;
sigma=30;
for i=1:1:N
    [N1(i),N2(i)]=BoxMuller(mu,sigma);
    [N3(i),N4(i)]=BoxMuller_Tri(mu,sigma);
end
N5=normrnd(mu,sigma,1,N);
figure(1);
DN=1000;
XLIM=[-120 120];
YLIM=[0 100];
subplot(5,5,1);
histfit(N1(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=1000','Interpreter','latex');
xlabel('Output of BoxMuller (1)');
subplot(5,5,2);
histfit(N2(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=1000','Interpreter','latex');
xlabel('Output of BoxMuller (2)');
subplot(5,5,3);
histfit(N3(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=1000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (1)');
subplot(5,5,4);
histfit(N4(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=1000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (2)');
subplot(5,5,5);
histfit(N5(1:DN),30,'normal');
title('$\mu=0,\sigma=30$,n=1000','Interpreter','latex');
xlim(XLIM);
ylim(YLIM);
xlabel('Output of normrnd');

DN=5000;
XLIM=[-120 120];
YLIM=[0 550];
subplot(5,5,6);
histfit(N1(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=5000','Interpreter','latex');
xlabel('Output of BoxMuller (1)');
subplot(5,5,7);
histfit(N2(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=5000','Interpreter','latex');
xlabel('Output of BoxMuller (2)');
subplot(5,5,8);
histfit(N3(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=5000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (1)');
subplot(5,5,9);
histfit(N4(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=5000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (2)');
subplot(5,5,10);
histfit(N5(1:DN),30,'normal');
title('$\mu=0,\sigma=30$,n=5000','Interpreter','latex');
xlim(XLIM);
ylim(YLIM);
xlabel('Output of normrnd');

DN=10000;
XLIM=[-120 120];
YLIM=[0 1300];
subplot(5,5,11);
histfit(N1(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=10000','Interpreter','latex');
xlabel('Output of BoxMuller (1)');
subplot(5,5,12);
histfit(N2(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=10000','Interpreter','latex');
xlabel('Output of BoxMuller (2)');
subplot(5,5,13);
histfit(N3(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=10000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (1)');
subplot(5,5,14);
histfit(N4(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=10000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (2)');
subplot(5,5,15);
histfit(N5(1:DN),30,'normal');
title('$\mu=0,\sigma=30$,n=10000','Interpreter','latex');
xlim(XLIM);
ylim(YLIM);
xlabel('Output of normrnd');

DN=50000;
XLIM=[-120 120];
YLIM=[0 7000];
subplot(5,5,16);
histfit(N1(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=50000','Interpreter','latex');
xlabel('Output of BoxMuller (1)');
subplot(5,5,17);
histfit(N2(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=50000','Interpreter','latex');
xlabel('Output of BoxMuller (2)');
subplot(5,5,18);
histfit(N3(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=50000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (1)');
subplot(5,5,19);
histfit(N4(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=50000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (2)');
subplot(5,5,20);
histfit(N5(1:DN),30,'normal');
title('$\mu=0,\sigma=30$,n=50000','Interpreter','latex');
xlim(XLIM);
ylim(YLIM);
xlabel('Output of normrnd');

DN=100000;
XLIM=[-120 120];
YLIM=[0 14000];
subplot(5,5,21);
histfit(N1(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=100000','Interpreter','latex');
xlabel('Output of BoxMuller (1)');
subplot(5,5,22);
histfit(N2(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=100000','Interpreter','latex');
xlabel('Output of BoxMuller (2)');
subplot(5,5,23);
histfit(N3(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=100000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (1)');
subplot(5,5,24);
histfit(N4(1:DN),30,'normal');
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=100000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (2)');
subplot(5,5,25);
histfit(N5(1:DN),30,'normal');
title('$\mu=0,\sigma=30$,n=100000','Interpreter','latex');
xlim(XLIM);
ylim(YLIM);
xlabel('Output of normrnd');

%%
figure(2);
DN=1000;
XLIM=[0 DN]
YLIM=[-100 100];
subplot(5,5,1);
plot(t(1:DN),N1(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=1000','Interpreter','latex');
xlabel('Output of BoxMuller (1)');
subplot(5,5,2);
plot(t(1:DN),N2(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=1000','Interpreter','latex');
xlabel('Output of BoxMuller (2)');
subplot(5,5,3);
plot(t(1:DN),N3(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=1000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (1)');
subplot(5,5,4);
plot(t(1:DN),N4(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=1000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (2)');
subplot(5,5,5);
plot(t(1:DN),N5(1:DN));
title('$\mu=0,\sigma=30$,n=1000','Interpreter','latex');
xlim(XLIM);
ylim(YLIM);
xlabel('Output of normrnd');

DN=5000;
XLIM=[0 DN]
YLIM=[-100 100];
subplot(5,5,6);
plot(t(1:DN),N1(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=5000','Interpreter','latex');
xlabel('Output of BoxMuller (1)');
subplot(5,5,7);
plot(t(1:DN),N2(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=5000','Interpreter','latex');
xlabel('Output of BoxMuller (2)');
subplot(5,5,8);
plot(t(1:DN),N3(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=5000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (1)');
subplot(5,5,9);
plot(t(1:DN),N4(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=5000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (2)');
subplot(5,5,10);
plot(t(1:DN),N5(1:DN));
title('$\mu=0,\sigma=30$,n=5000','Interpreter','latex');
xlim(XLIM);
ylim(YLIM);
xlabel('Output of normrnd');

DN=5000;
XLIM=[0 DN]
YLIM=[-100 100];
subplot(5,5,11);
plot(t(1:DN),N1(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=10000','Interpreter','latex');
xlabel('Output of BoxMuller (1)');
subplot(5,5,12);
plot(t(1:DN),N2(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=10000','Interpreter','latex');
xlabel('Output of BoxMuller (2)');
subplot(5,5,13);
plot(t(1:DN),N3(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=10000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (1)');
subplot(5,5,14);
plot(t(1:DN),N4(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=10000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (2)');
subplot(5,5,15);
plot(t(1:DN),N5(1:DN));
title('$\mu=0,\sigma=30$,n=10000','Interpreter','latex');
xlim(XLIM);
ylim(YLIM);
xlabel('Output of normrnd');

DN=50000;
XLIM=[0 DN]
YLIM=[-200 200];
subplot(5,5,16);
plot(t(1:DN),N1(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=50000','Interpreter','latex');
xlabel('Output of BoxMuller (1)');
subplot(5,5,17);
plot(t(1:DN),N2(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=50000','Interpreter','latex');
xlabel('Output of BoxMuller (2)');
subplot(5,5,18);
plot(t(1:DN),N3(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=50000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (1)');
subplot(5,5,19);
plot(t(1:DN),N4(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=50000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (2)');
subplot(5,5,20);
plot(t(1:DN),N5(1:DN));
title('$\mu=0,\sigma=30$,n=50000','Interpreter','latex');
xlim(XLIM);
ylim(YLIM);
xlabel('Output of normrnd');

DN=100000;
XLIM=[0 DN]
YLIM=[-200 200];
subplot(5,5,21);
plot(t(1:DN),N1(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=100000','Interpreter','latex');
xlabel('Output of BoxMuller (1)');
subplot(5,5,22);
plot(t(1:DN),N2(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=100000','Interpreter','latex');
xlabel('Output of BoxMuller (2)');
subplot(5,5,23);
plot(t(1:DN),N3(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=100000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (1)');
subplot(5,5,24);
plot(t(1:DN),N4(1:DN));
xlim(XLIM);
ylim(YLIM);
title('$\mu=0,\sigma=30$,n=100000','Interpreter','latex');
xlabel('Output of BoxMuller\_Tri (2)');
subplot(5,5,25);
plot(t(1:DN),N5(1:DN));
title('$\mu=0,\sigma=30$,n=100000','Interpreter','latex');
xlim(XLIM);
ylim(YLIM);
xlabel('Output of normrnd');

%%

figure(3);
subplot(2,2,1);
DR=1000;
plot(N1(1:DR),N2(1:DR),'b.');
xlim([-150 150]);
ylim([-150 150]);
title('$\mu=0,\sigma=30$,n=1000','Interpreter','latex');
xlabel('Output of BoxMuller (1)');
subplot(2,2,2);
DR=5000;
plot(N1(1:DR),N2(1:DR),'b.');
xlim([-150 150]);
ylim([-150 150]);
title('$\mu=0,\sigma=30$,n=5000','Interpreter','latex');
xlabel('Output of BoxMuller (1)');
xlabel('Output of BoxMuller (2)');
subplot(2,2,3);
DR=10000;
plot(N1(1:DR),N2(1:DR),'b.');
xlim([-150 150]);
ylim([-150 150]);
title('$\mu=0,\sigma=30$,n=10000','Interpreter','latex');
xlabel('Output of BoxMuller (1)');
xlabel('Output of BoxMuller (2)');
subplot(2,2,4);
DR=50000;
plot(N1(1:DR),N2(1:DR),'b.');
xlim([-150 150]);
ylim([-150 150]);
title('$\mu=0,\sigma=30$,n=50000','Interpreter','latex');
xlabel('Output of BoxMuller (1)');
xlabel('Output of BoxMuller (2)');
figure(4);
DR=100000;
plot(N1(1:DR),N2(1:DR),'b.');
xlim([-150 150]);
ylim([-150 150]);
title('$\mu=0,\sigma=30$,n=100000','Interpreter','latex');
xlabel('Output of BoxMuller (1)');
xlabel('Output of BoxMuller (2)');